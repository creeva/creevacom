
{"id":93910,"date":"2014-09-18T14:14:07","date_gmt":"2014-09-18T18:14:07","guid":{"rendered":"http:\/\/localhost\/wordpress\/?p=93910"},"modified":"2023-02-06T16:30:10","modified_gmt":"2023-02-06T16:30:10","slug":"converting-symantec-endpoint-encryption-device-control-logs-to-csv-files","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/index.php\/2014\/09\/18\/converting-symantec-endpoint-encryption-device-control-logs-to-csv-files\/","title":{"rendered":"Converting Symantec Endpoint Encryption &#8211; Device Control Logs to CSV files."},"content":{"rendered":"<p>&nbsp;<\/p>\n<p>Recently I had to do some work on Symantec Endpoint Encryption &#8211; Device Control. One of the major issues was to take the logs and convert them to a more usable format. Since there is very little information on the web in regards to this product, I thought I would share my code.<\/p>\n<p>There are a couple steps to this process that can be shortened and made easier. I will be working on streamlining this process. While the initial work is done with the windows server I exported the logs from &#8211; the script is being run on OSX. I have run into some issues porting the script directly to windows, this is more of an issue with my experience with Sed (windows port specifically).<\/p>\n<p>Once you export the logs they are in an xml format. While it&#8217;s plaintext underneath, there is quite a bit of extraneous information in the files. To strip this out I run this at the DOS command prompt on the server the logs are exported from:<\/p>\n<p>find &#8220;EV Sequence&#8221; &#8220;*.xml&#8221; &gt;log.txt<\/p>\n<p>This command gives you a file that is about half the size of the original .XML. Each line in the file will now look like this:<\/p>\n<blockquote><p> ClientHost=&#8221;workstationname&#8221; EventTime=&#8221;3\/14\/2014 10:13:50 AM&#8221; EventTimeLocal=&#8221;3\/14\/2014 4:13:50 PM&#8221; ServerTime=&#8221;3\/14\/2014 10:13:50 AM&#8221; CustomGroup=&#8221;&#8221; PolicyName=&#8221;Allow-And-Log&#8221; PolicyType=&#8221;User&#8221; DeviceDescription=&#8221;Disk drive&#8221; DeviceInfo=&#8221;USB DISK 2.0 USB Device&#8221; Port=&#8221;USB&#8221; BuiltinGroup=&#8221;Removable Storage Devices&#8221; DeviceVendor=&#8221;XXX&#8221; DeviceModel=&#8221;XXX&#8221; DeviceDistinctId=&#8221;XXXX&#8221; FileName=&#8221;homevideo.flv&#8221; FileExtension=&#8221;flv&#8221; FileSize=&#8221;500987&#8243; FileCreationTime=&#8221;3\/14\/2014 4:13:24 PM&#8221; FileModifyTime=&#8221;3\/14\/2014 4:13:26 PM&#8221; FileOperation=&#8221;Write&#8221; Details=&#8221;&#8221; FileType=&#8221;Multimedia&#8221; ContentInspectionResult=&#8221;0&#8243; ContentInspectionDetails=&#8221;&#8221; ContentInspectionTimeLocal=&#8221;&#8221; FileShadowingFingerprint=&#8221;&#8221; FileShadowingPath=&#8221;&#8221; FileShadowingFileName=&#8221;&#8221; \/&gt;<\/p><\/blockquote>\n<p>Once this has been done I copy the file over to the OSX machine to run the script against. Thanks to the find command there is going to be a line at the top of the file you have to remove. You can remove this line before or after you the script against the file. As part of the script, we wanted to make sure that we strip out any extra commas from the file that can throw off the formatting. The script will take these commas and replace them with spaces.<\/p>\n<p>Here is the script:<\/p>\n<p>&nbsp;<\/p>\n<blockquote><p>##############################################################################################<br \/>\n#<br \/>\n# This script is to take the log export from the Symantec Endpoint Device Control Product, it<br \/>\n# remove the data unnecessary data from an xml file and makes it reportable<br \/>\n#<br \/>\n#############################################################################################<br \/>\nunset LANG<br \/>\ncat log.txt | sed &#8216;s\/,\/ \/g&#8217; &gt;log2.txt<br \/>\nrm log.txt<br \/>\ncat log2.txt | sed &#8216;s\/&lt;.*User=&#8221;\/\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; ClientHost=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; EventTime=&#8221;\/,\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; EventTimeLocal=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; ServerTime=&#8221;.*PolicyName=&#8221;\/,\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; PolicyType=&#8221;.*DeviceDescription=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; DeviceInfo=&#8221;.*&#8221; Port=&#8221;\/,\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; BuiltinGroup=&#8221;.*&#8221; FileName=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; FileExtension=&#8221;\/,\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; FileSize=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; FileCreationTime=&#8221;.*&#8221; FileOperation=&#8221;\/,\/g&#8217; &gt;log1.txt<br \/>\ncat log1.txt | sed &#8216;s\/&#8221; Details=.*&#8221; FileType=&#8221;\/,\/g&#8217; &gt;log2.txt<br \/>\ncat log2.txt | sed &#8216;s\/&#8221; ContentInspectionResult=&#8221;.*&gt;\/,\/g&#8217; &gt;log1.txt<br \/>\n#############################################################################################<br \/>\n# Cleanup<br \/>\n#############################################################################################<br \/>\n# delete BOTH leading and trailing whitespace from each line<br \/>\ncat log1.txt | sed &#8216;s\/^[ \\t]*\/\/;s\/[ \\t]*$\/\/&#8217; &gt;log2.txt<br \/>\necho User,Host,Server Event Time,Workstation Event Time,Policy Name,Device Description,Port,File Name,File Extension,File Size,Action,File Type&gt;finished.csv<br \/>\ncat log2.txt &gt;&gt;finished.csv<br \/>\nrm log1.txt<br \/>\nrm log2.txt<\/p><\/blockquote>\n<p>&nbsp;<\/p>\n<p>As part of the output we place headers at the top of the file to make this easy to work with in Excel. The fields we use are User, Host ,Server Event Time, Workstation Event Time, Policy Name, Device Description, Port, File Name, File Extension, File Size, Action, and File Type. In the output a log line will now look like this (with another significant size reduction for the full file):<\/p>\n<blockquote><p>user@company.com,workstationname,3\/14\/2014 10:13:50AM,3\/14\/2014 4:13:50PM,Allow-And-Log,Diskdrive,USB,homevideo.flv,flv,500987,Write,Multimedia,<\/p><\/blockquote>\n<p>You then have a file named finished.csv that you can edit or look at to you hearts content. Pay attention to the amount of lines in the file. If there are over a million lines you will have to split the file if you wish to use it in Excel.<\/p>\n<p>I hope this helps someone out.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>&nbsp; Recently I had to do some work on Symantec Endpoint Encryption &#8211; Device Control. One of the major issues was to take the logs and convert them to a more usable format. Since there &hellip;<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[5],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/posts\/93910"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/comments?post=93910"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/posts\/93910\/revisions"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/media?parent=93910"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/categories?post=93910"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/index.php\/wp-json\/wp\/v2\/tags?post=93910"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}